<style>
  body {
    display: grid;
    place-content: center;
    background: #00b4ff;
  }

  .bubble {
    position: relative;
    height: 200px;
    width: 200px;
    border-radius: 50%;
    box-shadow: 0 20px 30px rgba(0, 0, 0, 0.2), inset 0px 10px 30px 5px rgba(255, 255, 255, 1);
    transition: width 0.3s ease, 
            height 0.3s ease, 
            opacity 0.3s ease, 
            transform 0.3s ease,

  }

  aside {
    display: flex;
    flex-direction: column;
    gap: 5px;
    position: fixed;
    top: 40px;
    right: 40px;
  }

  button {
    padding: 10px 20px;
    border: none;
    border-radius: 5px;
    background-color: #003566;
    color: white;
    cursor: pointer;
    font-size: 24px;
  }

  button:hover {
    background-color: #00539c;
  }
</style>

<div class="bubble"></div>

<aside>
  <button type="button" id="inflate">Inflate</button>
  <button type="button" id="deflate">Deflate</button>
</aside>

<script>
let bubble = document.querySelector('.bubble');
const inflateBtn = document.getElementById('inflate');
const deflateBtn = document.getElementById('deflate');
const inflateSound = new Audio("inflate.mp3");
const deflateSound = new Audio("deflate.mp3");
const popSound = new Audio("pop.mp3");

let size = 200;
const maxSize = 400;

function randomBetween(min, max) {
  return Math.random() * (max - min) + min;
}

function setRandomTransition() {
  const widthTime = randomBetween(0.4, 0.9);
  const heightTime = randomBetween(0.2, 0.4);

  bubble.style.transition =
    `width ${widthTime}s ease, height ${heightTime}s ease,
     opacity 0.3s ease, transform 0.3s ease, background 0.2s ease`;
}

function popBubble() {

  popSound.currentTime = 0;
  popSound.play();

  bubble.style.background = "white";
  bubble.style.transform = "scale(1.2)";
  bubble.style.opacity = "0";

  setTimeout(() => {
    bubble.remove();

    setTimeout(() => {
      createNewBubble();
    }, 1000);

  }, 300);
}


function createNewBubble() {
  bubble = document.createElement('div');
  bubble.classList.add('bubble');

  // 重置尺寸
  size = 200;
  bubble.style.width = size + "px";
  bubble.style.height = size + "px";

  document.body.appendChild(bubble);
}

inflateBtn.addEventListener('click', function () {
  if (!bubble) return;

  inflateSound.currentTime = 0; // allow rapid replay
  inflateSound.play();

  setRandomTransition();
  size += 20;

  if (size >= maxSize) {
    popBubble();
  } else {
    bubble.style.width = size + 'px';
    bubble.style.height = size + 'px';
  }
});

deflateBtn.addEventListener('click', function () {
  if (!bubble) return;

  if (size > 40) {

    deflateSound.currentTime = 0;
    deflateSound.play();

    setRandomTransition();
    size -= 20;
    bubble.style.width = size + 'px';
    bubble.style.height = size + 'px';
  }
});



</script>
